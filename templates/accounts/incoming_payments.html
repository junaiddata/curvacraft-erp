{% extends "base.html" %}
{% load humanize %}
{% block title %}Incoming Payments{% endblock %}
{% block content %}
<div class="list-page">
<div class="page-header">
    <h1 class="page-title">Incoming Payments</h1>
    <a href="{% url 'accounts:dashboard' %}" class="btn btn-secondary">← Accounts</a>
</div>

<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Amount (AED)</th>
                <th>Payment Mode</th>
                <th>Project</th>
                <th>Invoice</th>
                <th>Remarks</th>
            </tr>
        </thead>
        <tbody>
            {% for payment in payments %}
            <tr>
                <td>{{ payment.date_paid|date:"d M Y" }}</td>
                <td style="text-align: right; font-variant-numeric: tabular-nums;">{{ payment.amount|floatformat:2|intcomma }}</td>
                <td>{{ payment.payment_method|default:"—" }}</td>
                <td>
                    <a href="{% url 'projects:project_detail' pk=payment.invoice.project.pk %}">{{ payment.invoice.project.title }}</a>
                    <br><small class="text-muted">{{ payment.invoice.project.customer.name }}</small>
                </td>
                <td>
                    <a href="{% url 'invoices:invoice_detail' pk=payment.invoice.pk %}">{{ payment.invoice.invoice_number }}</a>
                </td>
                <td style="max-width: 200px;">{{ payment.notes|default:"—"|truncatewords:12 }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" style="text-align: center; padding: 2rem;" class="text-muted">No payments recorded yet.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</div>
{% endblock %}
